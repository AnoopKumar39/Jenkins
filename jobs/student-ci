pipeline {
    agent {
        node {
            label 'MAVEN'
        }
    }
    environment {
        SONAR_URL="sonar.devopsprac.ml"
        SONAR_TOKEN=credentials('StudentappToken')


    }
      stages {
          stage('Cloning Repo') {
              steps {
                  git credentialsId: 'GitUserPass', url: 'https://github.com/AnoopKumar39/studentapp-ui.git'
              }
          }
          stage('Maven Compile') {
              steps {
                  sh label: '', script: 'mvn compile'
              }
          }
          stage('CodeQualityCheck') {
              steps {
                  sh label: '', script: '''mvn sonar:sonar \\
                   -Dsonar.projectKey=Student-CI \\
                   -Dsonar.host.url=http://${SONAR_URL}:9000 \\
                   -Dsonar.login=${SONAR_TOKEN}
                   echo ${SONAR_TOKEN} | base 64'''
              }
          }
      }
}